@model IEnumerable<Cred.Models.PreviousEmployment>
@{
    ViewData["Title"] = "Previous Employment";
}

<div class="container-fluid mt-4">
    <h2>Previous Employment</h2>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    }

    <!-- Employment Form -->
    <div class="row mb-4">
        <div class="col-md-6">
            <form method="post" action="/PreviousEmployment/Create">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="EmployeeId" class="form-label">Employee</label>
                        <select name="EmployeeId" id="EmployeeId" class="form-select" required>
                            <option value="">Select Employee</option>
                            @foreach (var emp in ViewBag.Employees as SelectList)
                            {
                                <option value="@emp.Value">@emp.Text</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="CompanyName" class="form-label">Company Name</label>
                        <input name="CompanyName" id="CompanyName" class="form-control" required />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="JobTitle" class="form-label">Job Title</label>
                        <input name="JobTitle" id="JobTitle" class="form-control" required />
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="FromDate" class="form-label">From Date</label>
                        <input name="FromDate" id="FromDate" type="date" class="form-control" required />
                    </div>
                </div>

                <div class="mb-3">
                    <label for="ToDate" class="form-label">To Date</label>
                    <input name="ToDate" id="ToDate" type="date" class="form-control" />
                </div>

                <div class="mb-3">
                    <button type="submit" class="btn btn-success me-2">Save</button>
                    <button type="button" class="btn btn-secondary" onclick="resetEmploymentForm()">Reset</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Employment List -->
    <h3>Employment List</h3>
    <div class="table-responsive">
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>Employee</th>
                    <th>Job Title</th>
                    <th>From Date</th>
                    <th>To Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.Employee.Name</td>
                            <td>@item.JobTitle</td>
                            <td>@item.FromDate.ToString("M/d/yyyy")</td>
                            <td>@(item.ToDate?.ToString("M/d/yyyy") ?? "Present")</td>
                            <td>
                                <a href="/PreviousEmployment/Edit/@item.Id" class="btn btn-sm btn-primary me-1">Edit</a>
                                <a href="/PreviousEmployment/Delete/@item.Id" class="btn btn-sm btn-danger">Delete</a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="5" class="text-center">No employment records found.</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <div class="mt-3">
        <a href="/Employees" class="btn btn-primary">Back to Employee Management</a>
    </div>
</div>

<script>
    function resetEmploymentForm() {
        document.getElementById('EmployeeId').value = '';
        document.getElementById('CompanyName').value = '';
        document.getElementById('JobTitle').value = '';
        document.getElementById('FromDate').value = '';
        document.getElementById('ToDate').value = '';
    }
</script>
